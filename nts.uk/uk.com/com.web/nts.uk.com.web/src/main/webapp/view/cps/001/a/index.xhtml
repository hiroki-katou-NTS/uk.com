<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:com="http://xmlns.jcp.org/jsf/component"
	xmlns:h="http://xmlns.jcp.org/jsf/html">
<body>
	<ui:composition template="/master/base.xhtml">
		<ui:define name="htmlHead">
			<title>#{i18n.getText('CPS001_1')}</title>
			<com:scriptfile set="IGNITE" />

			<com:stylefile path="/view/ccg/share/style.css" of="/nts.uk.com.web" />
			<com:scriptfile path="/view/kcp/share/list.js" of="/nts.uk.com.web" />
			<com:scriptfile path="/view/kcp/share/tree.js" of="/nts.uk.com.web" />
			<com:scriptfile path="/view/ccg/share/ccg.service.js"
				of="/nts.uk.com.web" />
			<com:scriptfile path="/view/ccg/share/ccg.vm.js" of="/nts.uk.com.web" />

			<com:stylefile path="cps001.a.style.css" />
			<com:scriptfile path="/view/cps/007/a/layout-control-ko-ext.js"
				of="/nts.uk.com.web" />
			<com:scriptfile path="cps001.a.service.js" />
			<com:scriptfile path="cps001.a.vm.js" />
			<com:scriptfile path="cps001.a.start.js" />
		</ui:define>

		<ui:define name="content">
			<div id="functions-area">
				<button type="button" class="proceed" data-bind="click: saveData">#{i18n.getText('CPS001_4')}</button>
				<button type="button" data-bind="click: unManagerEmployee">#{i18n.getText('CPS001_5')}</button>
				<button type="button" class="danger"
					data-bind="click: deleteEmployee">#{i18n.getText('CPS001_6')}</button>
				<a class="goout"
					data-bind="ntsLinkButton: { jump: '/view/cas/001/a/index.xhtml' }">#{i18n.getText('CPS001_7')}</a>
				<a class="goout"
					data-bind="ntsLinkButton: { jump: '/view/cps/008/a/index.xhtml' }">#{i18n.getText('CPS001_8')}</a>
			</div>
			<div id="contents-area" class="cf"
				data-bind="let: { 
						text: nts.uk.resource.getText,
						catType: {	
							SINGLE : 1,
							MULTI: 2,
							CONTI: 3, /* continuos history hasn't end date */
							NODUP: 4,
							DUPLI: 5,
							CONTIWED: 6 /* continuos history has end date */
						}
					}">
				<div id="ccgcomponent"></div>
				<div class="left-area">
					<div class="bg-green caret-right caret-background"
						data-bind="let: { emp: employee() }">
						<div id="employees"
							data-bind="template: {	
								name: 'list-data',
								data: {
									value: emp.employeeId,
									dataSource: listEmployee,
									primaryKey: 'employeeId',
									columns: [
										{ headerText: 'コード', key: 'employeeId', width: 100, hidden: true },
			                			{ headerText: text('CPS001_9'), key: 'employeeCode', width: 115, hidden: false },
			                			{ headerText: '', key: 'employeeName', width: 125, hidden: false }
									],
								}
							}"></div>
					</div>
					<div id="lefttabs"
						data-bind="ntsTabPanel: {
							dataSource: [
								{
									id: 'layout', 
									title: text('CPS001_23'), 
									content: '.layouttab', 
									enable: ko.observable(true), 
									visible: ko.observable(true)
								},
								{
									id: 'category', 
									title: text('CPS001_24'), 
									content: '.categorytab', 
									enable: ko.observable(true), 
									visible: ko.observable(true)
								}], 
							active: tabActive
							}">
						<div class="layouttab" data-bind="let: { layout: currentLayout()}">
							<div
								data-bind="ntsSearchBox: {
									searchMode: 'highlight',
									targetKey: 'code',
									comId: 'layouts',
									items: ko.observableArray([]),
									selectedKey: 'code', 
									fields: ['name', 'code'], 
									mode: 'igGrid'}"></div>
							<div
								data-bind="template: { name: 'list-data', data: {
									dataSource: listLayout,
									value: layout.id,
									primaryKey: 'id',
									columns: [
										{ headerText: 'コード', key: 'id', width: 100, hidden: true },
			                			{ headerText: text('CPS001_25'), key: 'name', width: 232, hidden: false }
									],
								} }">
							</div>
						</div>
						<div class="categorytab"
							data-bind="let: { cat: currentCategory()} ">
							<div class="form-group search-box">
								<button type="button">#{i18n.getText('CPS001_27')}</button>
								<div id="combo-box"
									data-bind="ntsComboBox: {
										options: listCategory,
										visibleItemsCount: 5,
										value: cat.id,
										optionsText: 'categoryName',
										optionsValue: 'id',
										editable: false,
										enable: true,
										columns: [{ prop: 'categoryName', length: 10 }]}"></div>
							</div>
							<div
								data-bind="css: { 'hidden' : cat.categoryType() != catType.SINGLE }">
								<div
									data-bind="template: { name: 'list-data', data: { 
											dataSource: ko.observableArray([]),
											value: ko.observable(''),
											primaryKey: 'id',
											columns: [
												{ headerText: 'コード', key: 'id', width: 100, hidden: true },
					                			{ headerText: text('CPS001_25'), key: 'name', width: 232, hidden: false }
											],
										}
									}">
								</div>
							</div>
							<div
								data-bind="css: { 'hidden' : cat.categoryType() != catType.MULTI }">
								<div
									data-bind="template: { name: 'list-multiple', data: { 
										list: {
											value: ko.observable(), 
											dataSource: ko.observableArray([]),
											primaryKey: 'id',
											columns: [
												{ headerText: 'コード', key: 'id', width: 100, hidden: true },
					               				{ headerText: '名称', key: 'name', width: 232, hidden: false }
											]
										},
										event: {
											add: function() {},
											delete: function() {}						
										}
									} }">
								</div>
							</div>
							<div
								data-bind="css: { 'hidden' : cat.categoryType() != catType.CONTI }">
								<div
									data-bind="template: { name: 'list-history', data: {
										list: {
											value: ko.observable(), 
											dataSource: ko.observableArray([]),
											primaryKey: 'id',
											columns: [
												{ headerText: 'コード', key: 'id', width: 100, hidden: true },
					               				{ headerText: '名称', key: 'name', width: 232, hidden: false }
											]
										},
										event: {
											add: function() {},
											replication: function() {},
											delete: function() {}
										}
									} }">
								</div>
							</div>
							<div
								data-bind="css: { 'hidden' : cat.categoryType() != catType.NODUP }">
								<div
									data-bind="template: { name: 'list-data', data: { 
											dataSource: ko.observableArray([]),
											value: ko.observable(''),
											primaryKey: 'id',
											columns: [
												{ headerText: 'コード', key: 'id', width: 100, hidden: true },
					                			{ headerText: text('CPS001_25'), key: 'name', width: 232, hidden: false }
											],
										}
									}">
								</div>
							</div>
							<div
								data-bind="css: { 'hidden' : cat.categoryType() != catType.DUPLI }">
								<div
									data-bind="template: { name: 'list-data', data: { 
											dataSource: ko.observableArray([]),
											value: ko.observable(''),
											primaryKey: 'id',
											columns: [
												{ headerText: 'コード', key: 'id', width: 100, hidden: true },
					                			{ headerText: text('CPS001_25'), key: 'name', width: 232, hidden: false }
											],
										}
									}">
								</div>
							</div>
							<div
								data-bind="css: { 'hidden' : cat.categoryType() != catType.CONTIWED }">
								<div
									data-bind="template: { name: 'list-history', data: { 
										list: {
											value: ko.observable(), 
											dataSource: ko.observableArray([]),
											primaryKey: 'id',
											columns: [
												{ headerText: 'コード', key: 'id', width: 100, hidden: true },
					               				{ headerText: '名称', key: 'name', width: 232, hidden: false }
											]
										},
										event: {
											add: function() {},
											replication: function() {},
											delete: function() {}
										}
									} }">
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="right-area"
					data-bind="let: {
							_auth: auth(),
							_pers: person(), 
							_emp: employee()
						}">
					<div class="top-right-area cf">
						<div class="avatar-group">
							<div class="active-panel" data-bind="click: chooseAvatar">
								<img data-bind="attr: { src: _emp.avatar}" class="avatar" />
							</div>
						</div>
						<div class="person-group">
							<div class="active-panel">
								<table class="person-info">
									<tbody>
										<tr>
											<td class="bg-calendar-ym-set">#{i18n.getText('CPS001_11')}</td>
											<td>
												<div class="info">
													<span data-bind="text: _emp.employeeCode"></span> <span
														data-bind="text: _pers.fullName"></span>
												</div>
											</td>
										</tr>
										<tr>
											<td class="bg-calendar-ym-set">#{i18n.getText('CPS001_12')}</td>
											<td>
												<div class="info first" data-bind="text: _pers.age()"></div>
												<div class="info bg-calendar-ym-set">#{i18n.getText('CPS001_13')}</div>
												<div class="info" data-bind="text: _emp.entire()"></div>
											</td>
										</tr>
										<tr>
											<td class="bg-calendar-ym-set">#{i18n.getText('CPS001_14')}</td>
											<td><span data-bind="text: _emp.workplaceCode"></span> <span
												data-bind="text: _emp.workplaceName"></span></td>
										</tr>
										<tr>
											<td class="bg-calendar-ym-set">#{i18n.getText('CPS001_15')}</td>
											<td>
												<div class="info first" data-bind="text: ''"></div>
												<div class="info bg-calendar-ym-set">#{i18n.getText('CPS001_16')}</div>
												<div class="info" data-bind="text: ''"></div>
											</td>
										</tr>
									</tbody>
								</table>
							</div>
						</div>
						<div class="action-group">
							<div class="active-panel cf">
								<div class="column">
									<button class="btn btn-location" type="button"
										data-bind="click: pickLocation, enable: _auth.allowMapBrowse()">#{i18n.getText('CPS001_20')}</button>
									<button class="btn btn-details" type="button"
										data-bind="click: uploadebook, enable: _auth.allowDocRef()">#{i18n.getText('CPS001_19')}</button>
								</div>
								<div class="column">
									<button class="btn btn-print" type="button">#{i18n.getText('CPS001_17')}</button>
								</div>
							</div>
							<div class="active-panel">
								<a class="btn-goout">出向に来ています</a>
							</div>
						</div>
					</div>
					<div class="bottom-right-area"
						data-bind="let: { layout: currentLayout(),
										  cat: currentCategory() }">
						<div class="layout-input"
							data-bind="css: { 'hidden': tabActive() != 'layout'}">
							<div class="form-group">
								<div data-bind="ntsFormLabel: {}">#{i18n.getText('CPS001_35')}</div>
								<div
									data-bind="ntsDatePicker: {
								value: layout.standardDate, 
								dateFormat: 'YYYY/MM/DD'}"></div>
								<button data-bind="click: layout.filterData.bind(layout)">#{i18n.getText('CPS001_37')}</button>
							</div>
							<div
								data-bind="template: { 
									name: 'simple-layout', 
									data: {
										items: layout.listItemCls,
										outData: layoutData
								 	}
								}"></div>
						</div>
						<div class="category-input"
							data-bind="let: { resource: titleResource() },
									   css: { 'hidden': tabActive() != 'category'}">
							<div class="title" data-bind="text: text(resource)"></div>
							<div data-bind="css: {'hidden': cat.hasChilds() == true}" class="cat-no-childs">
								<div
									data-bind="template: { 
									name: 'simple-layout', 
									data: {
										items: layout.listItemCls
								 	}
								}"></div>
							</div>
							<div data-bind="css: {'hidden': cat.hasChilds() == false}" class="cat-has-childs">
								<div
									data-bind="template: { 
									name: 'cat-with-child', 
									data: {
										currentTabCategory: currentTabCategory,
										listItemCls: layout.listItemCls
								 	}
								}"></div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<script type="text/html" id="list-data"
				data-structor="{
					value: ko.observable(), 
					dataSource: ko.observableArray([]),
					primaryKey: 'id',
					columns: [
						{ headerText: 'コード', key: 'id', width: 100, hidden: true },
               			{ headerText: '名称', key: 'name', width: 232, hidden: false }
					],
				}">
				<table id="grid-data"
					data-bind="ntsGridList: {								
						rows: 10,
						multiple: false,
						columns: $data.columns || [
							{ headerText: 'コード', key: 'id', width: 100, hidden: true },
               				{ headerText: '名称', key: 'name', width: 232, hidden: false }
						],
						primaryKey: $data.primaryKey || 'id',
						value: $data.value || ko.observable(),
						dataSource: $data.dataSource || ko.observableArray([])
					}"></table>
			</script>
			<script type="text/html" id="list-history"
				data-structor="{
					list: {
						value: ko.observable(), 
						dataSource: ko.observableArray([]),
						primaryKey: 'id',
						columns: [
							{ headerText: 'コード', key: 'id', width: 100, hidden: true },
               				{ headerText: '名称', key: 'name', width: 232, hidden: false }
						]
					},
					event: {
						add: function() {},
						replication: function() {},
						delete: function() {}
					}
				}">
				<div class="form-group search-box">
					<button type="button" class="btn-add" data-bind="click: $data.event.add || function() {}">#{i18n.getText('CPS001_32')}</button>
					<button type="button" class="btn-repli" data-bind="click: $data.event.replication || function() {}">#{i18n.getText('CPS001_33')}</button>
					<button type="button" class="btn-delete danger" data-bind="click: $data.event.delete || function() {}">#{i18n.getText('CPS001_34')}</button>
				</div>
				<div data-bind="template: {
						name: 'list-data',
						data: {
							value: $data.list.value,
							dataSource: $data.list.dataSource,
							primaryKey: $data.list.primaryKey || 'id',
							columns: $data.list.columns || [
								{ headerText: 'コード', key: 'maintenanceLayoutID', width: 100, hidden: true },
                				{ headerText: text('CPS001_25'), key: 'layoutName', width: 232, hidden: false }
							]
						}
					}">
				</div>
			</script>
			<script type="text/html" id="list-multiple"
				data-structor="{
					list: {
						value: ko.observable(), 
						dataSource: ko.observableArray([]),
						primaryKey: 'id',
						columns: [
							{ headerText: 'コード', key: 'id', width: 100, hidden: true },
               				{ headerText: '名称', key: 'name', width: 232, hidden: false }
						]
					},
					event: {
						add: function() {},
						delete: function() {}						
					}
				}">
				<div class="form-group search-box">
					<button type="button" class="btn-add" data-bind="click: $data.event.add || function() {}">#{i18n.getText('CPS001_32')}</button>
					<button type="button" class="btn-delete danger" data-bind="click: $data.event.delete || function() {}">#{i18n.getText('CPS001_34')}</button>
				</div>
				<div data-bind="template: {
						name: 'list-data',
						data: {
							value: $data.list.value,
							dataSource: $data.list.dataSource,
							primaryKey: $data.list.primaryKey || 'id',
							columns: $data.list.columns || [
								{ headerText: 'コード', key: 'maintenanceLayoutID', width: 100, hidden: true },
                				{ headerText: text('CPS001_25'), key: 'layoutName', width: 232, hidden: false }
							]
						}
					}">
				</div>
			</script>
			<script type="text/html" id="simple-layout"
				data-structor="{
					items: listItemClassification,
					outData: outData
				}">
				<div style="padding-top: 10px"
					data-bind="ntsLayoutControl: { 
					data: $data.items,
					outData: $data.outData,
					editAble: 2 }"></div>
			</script>
			<script type="text/html" id="multiple-layout"
				data-structor="{
					items: listItemClassification
				}">
				<div style="padding-top: 10px"
					data-bind="ntsLayoutControl: { 
					data: $data.items,
					editAble: 2 }"></div>
			</script>
			<script type="text/html" id="cat-with-child">
				<div id="category-tab"
					data-bind="ntsTabPanel: {
							dataSource: [
								{
									id: 'cat1', 
									title: text('CPS001_23'), 
									content: '.cat1', 
									enable: ko.observable(true), 
									visible: ko.observable(true)
								},
								{
									id: 'cat2', 
									title: text('CPS001_24'), 
									content: '.cat2', 
									enable: ko.observable(true), 
									visible: ko.observable(true)
								}],
							active: $data.currentTabCategory
							}">
					<div class="cat1">
							<div
								data-bind="template: { 
									name: 'simple-layout', 
									data: {
										items: $data.listItemCls
								 	}
								}"></div>
					</div>
					<div class="cat2">

							<div
								data-bind="template: { 
									name: 'simple-layout', 
									data: {
										items: $data.listItemCls
								 	}
								}"></div>
					</div>
				</div>
			</script>
			<script type="text/html" id="cat-with-history">
			</script>
		</ui:define>
	</ui:composition>
</body>
</html>
